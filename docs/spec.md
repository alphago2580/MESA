# MESA v2 - 기능 스펙 문서

> 버전: 1.0.0 | 최종 수정: 2026-02-21

## 1. 서비스 개요

MESA v2는 AI 기반 거시경제 인사이트 리포트 서비스이다.
사용자가 원하는 경제 지표, 수신 주기, 리포트 깊이를 설정하면,
자동으로 분석 리포트를 생성하여 Web Push 알림으로 전달한다.

## 2. 사용자 유형

| 유형 | 설명 |
|------|------|
| 주린이 (Beginner) | 경제/투자 초보자. 쉬운 용어와 비유 중심의 리포트 필요 |
| 일반 (Standard) | 기본적인 경제 지식 보유. 표준 분석 리포트 |
| 전문가 (Expert) | 심화 분석, 기술적 지표, 계량 데이터 중심 리포트 |

## 3. 기능 요구사항

### FR-01: 회원 관리

| ID | 기능 | 설명 | 우선순위 |
|----|------|------|----------|
| FR-01-1 | 회원가입 | 이메일 + 비밀번호로 가입 | P0 |
| FR-01-2 | 로그인 | JWT 토큰 기반 인증 | P0 |
| FR-01-3 | 프로필 관리 | 이메일, 비밀번호 변경 | P1 |

### FR-02: 리포트 설정

| ID | 기능 | 설명 | 우선순위 |
|----|------|------|----------|
| FR-02-1 | 수신 주기 설정 | 일간(Daily) / 주간(Weekly) / 월간(Monthly) 선택 | P0 |
| FR-02-2 | 관심 지표 선택 | 복수 선택 가능. 아래 지표 목록 참조 | P0 |
| FR-02-3 | 리포트 레벨 선택 | 주린이 / 일반 / 전문가 | P0 |
| FR-02-4 | 수신 시간 설정 | 리포트를 받고 싶은 시간 지정 (기본: 08:00 KST) | P1 |

### FR-03: 리포트 생성 및 조회

| ID | 기능 | 설명 | 우선순위 |
|----|------|------|----------|
| FR-03-1 | 자동 리포트 생성 | 스케줄러에 의한 정기 생성 | P0 |
| FR-03-2 | 수동 리포트 생성 | 사용자가 즉시 생성 요청 | P1 |
| FR-03-3 | 리포트 목록 조회 | 생성된 리포트 목록 (페이지네이션) | P0 |
| FR-03-4 | 리포트 상세 조회 | HTML 형식의 리포트 열람 | P0 |
| FR-03-5 | 리포트 삭제 | 개별 리포트 삭제 | P2 |

### FR-04: Push 알림

| ID | 기능 | 설명 | 우선순위 |
|----|------|------|----------|
| FR-04-1 | Push 구독 등록 | Service Worker 기반 Web Push 구독 | P0 |
| FR-04-2 | 리포트 알림 수신 | 새 리포트 생성 시 Push 알림 | P0 |
| FR-04-3 | 알림 클릭 이동 | 알림 클릭 시 해당 리포트로 이동 | P0 |
| FR-04-4 | Push 구독 해제 | 알림 수신 중지 | P1 |

### FR-05: 대시보드

| ID | 기능 | 설명 | 우선순위 |
|----|------|------|----------|
| FR-05-1 | 최신 리포트 요약 | 메인 화면에 최근 리포트 Executive Summary 표시 | P0 |
| FR-05-2 | 주요 지표 현황 | 관심 지표의 현재 수치 간략 표시 | P1 |
| FR-05-3 | 설정 바로가기 | 리포트 설정으로 빠르게 이동 | P1 |

## 4. 경제 지표 목록

사용자가 선택할 수 있는 경제 지표 (상세 메타데이터: `backend/app/data/indicators_config.json`):

### 금리/통화정책 (Interest Rates)

| ID | 지표명 | 소스 | 중요도 | 기본 선택 |
|----|--------|------|--------|-----------|
| fed_funds_rate | 미국 기준금리 | FRED (DFF) | 5 | O |
| bok_base_rate | 한국 기준금리 | ECOS | 5 | O |
| us_10y_treasury | 미국 10년물 국채금리 | FRED (DGS10) | 5 | O |
| kr_10y_bond | 한국 10년물 국채금리 | ECOS | 4 | - |
| us_2y_treasury | 미국 2년물 국채금리 | FRED (DGS2) | 4 | - |
| us_yield_spread_10y2y | 장단기 금리차 (10Y-2Y) | FRED (T10Y2Y) | 5 | O |

### 물가/인플레이션 (Inflation)

| ID | 지표명 | 소스 | 중요도 | 기본 선택 |
|----|--------|------|--------|-----------|
| us_cpi | 미국 소비자물가지수 (CPI) | FRED (CPIAUCSL) | 5 | O |
| kr_cpi | 한국 소비자물가지수 | KOSIS | 4 | - |
| us_ppi | 미국 생산자물가지수 (PPI) | FRED (PPIFES) | 3 | - |
| us_pce | 개인소비지출 물가지수 (PCE) | FRED (PCEPI) | 5 | O |

### 고용 (Employment)

| ID | 지표명 | 소스 | 중요도 | 기본 선택 |
|----|--------|------|--------|-----------|
| us_unemployment | 미국 실업률 | FRED (UNRATE) | 5 | O |
| us_nfp | 비농업부문 고용 (NFP) | FRED (PAYEMS) | 5 | O |
| kr_unemployment | 한국 실업률 | KOSIS | 3 | - |

### 경제성장 (Growth)

| ID | 지표명 | 소스 | 중요도 | 기본 선택 |
|----|--------|------|--------|-----------|
| us_gdp | 미국 GDP | FRED (GDPC1) | 4 | O |
| kr_gdp | 한국 GDP | ECOS | 4 | - |
| ism_manufacturing_pmi | ISM 제조업 PMI | ISM/FRED | 4 | O |
| ism_services_pmi | ISM 서비스업 PMI | ISM/FRED | 4 | O |

### 시장지수 (Market Indices)

| ID | 지표명 | 소스 | 중요도 | 기본 선택 |
|----|--------|------|--------|-----------|
| sp500 | S&P 500 | FRED/Yahoo (^GSPC) | 5 | O |
| nasdaq | 나스닥 종합지수 | FRED/Yahoo (^IXIC) | 4 | O |
| kospi | KOSPI | Yahoo (^KS11) | 4 | O |
| kosdaq | KOSDAQ | Yahoo (^KQ11) | 3 | - |
| vix | VIX (공포지수) | FRED/Yahoo (^VIX) | 4 | O |

### 환율/원자재 (FX & Commodities)

| ID | 지표명 | 소스 | 중요도 | 기본 선택 |
|----|--------|------|--------|-----------|
| usd_krw | 원달러 환율 (USD/KRW) | FRED/Yahoo (KRW=X) | 5 | O |
| dxy | 달러인덱스 (DXY) | FRED/Yahoo (DX-Y.NYB) | 4 | O |
| wti_crude | WTI 원유 | FRED/Yahoo (CL=F) | 4 | O |
| gold | 금 가격 | FRED/Yahoo (GC=F) | 4 | O |

## 5. 리포트 형식 스펙

### 5.1 공통 구조 (두괄식)

모든 리포트는 반드시 아래 구조를 따른다:

```
[Executive Summary]     ← 필수. 반드시 3줄. 리포트의 핵심만 담음.

[지표 분석]             ← 사용자가 선택한 각 지표별 분석
  - 지표명
  - 현재 수치 및 변동
  - 의미 해석

[종합 분석]             ← 지표 간 관계 및 전체적인 경제 동향

[전망 및 시사점]        ← 향후 예상 및 주의 사항

[부록: 데이터 테이블]   ← 수집된 원시 데이터 요약 표
```

### 5.2 레벨별 차이

| 항목 | 주린이 | 일반 | 전문가 |
|------|--------|------|--------|
| 어투 | 친근한 구어체 | 표준 보고서체 | 학술/전문 보고서체 |
| 용어 | 쉬운 말 + 괄호 설명 | 일반 경제 용어 | 전문 용어 적극 활용 |
| 비유 | 일상 비유 많이 사용 | 필요시 사용 | 사용하지 않음 |
| 데이터 깊이 | 핵심 수치만 | 주요 데이터 + 추이 | 상세 통계 + 상관분석 |
| 분량 | 짧음 (500-800자) | 중간 (800-1500자) | 긴 글 (1500-3000자) |
| 시각화 | 간단한 방향 표시 | 기본 차트 | 복합 차트 + 데이터 테이블 |

### 5.3 HTML 리포트 요구사항

- 반응형 디자인 (모바일 / 데스크톱)
- 다크모드 지원
- 인쇄 가능한 레이아웃
- 인라인 CSS (외부 의존성 없이 독립 표시 가능)

## 6. 비기능 요구사항

### NFR-01: 성능

| 항목 | 목표 |
|------|------|
| 리포트 생성 시간 | 30초 이내 (AI 응답 포함) |
| API 응답 시간 | 200ms 이내 (리포트 생성 제외) |
| 동시 사용자 | 100명 (초기 목표) |

### NFR-02: 가용성

| 항목 | 목표 |
|------|------|
| 스케줄러 안정성 | 실패 시 3회 재시도 |
| 데이터 수집 실패 시 | 캐시된 최근 데이터 사용 |
| Push 전송 실패 시 | 재시도 + 앱 내 알림 표시 |

### NFR-03: 보안

- API 키는 환경변수로 관리
- JWT 인증 (access token + refresh token)
- HTTPS 필수
- CORS 설정으로 허용 도메인 제한

## 7. 외부 의존성

| 서비스 | 용도 | 비용 |
|--------|------|------|
| Claude API | 리포트 생성 | 사용량 기반 과금 |
| FRED API | 거시경제 데이터 | 무료 (API 키 필요) |
| Yahoo Finance | 시장 데이터 | 무료 (yfinance 라이브러리) |
| World Bank API | 글로벌 경제 데이터 | 무료 |
| Web Push Service | 알림 전달 | 무료 (브라우저 내장) |

## 8. 페이지 구성

### 8.1 대시보드 (메인 페이지)
- 최신 리포트의 Executive Summary 카드
- 주요 관심 지표 실시간 스냅샷
- 빠른 설정 접근 버튼

### 8.2 리포트 목록
- 날짜별 리포트 카드 목록
- 각 카드에 Executive Summary 미리보기
- 페이지네이션
- 레벨/날짜 필터

### 8.3 리포트 뷰어
- HTML 리포트 전체 표시
- 인쇄 버튼
- 이전/다음 리포트 네비게이션

### 8.4 설정 페이지
- 리포트 주기 선택 (라디오)
- 관심 지표 선택 (체크박스 그리드)
- 리포트 레벨 선택 (카드형 선택)
- 수신 시간 설정 (타임 피커)
- Push 알림 설정 (토글)

## 9. 개발 우선순위 (MVP)

**Phase 1 - MVP (P0 기능)**
1. 백엔드: FastAPI 기본 구조 + DB 모델
2. 데이터 수집: FRED API 연동
3. AI 리포트 생성: Claude API 연동 + 프롬프트 구현
4. 프론트엔드: 설정 페이지 + 리포트 뷰어
5. Push 알림: Web Push 기본 구현
6. 스케줄러: APScheduler 연동

**Phase 2 - 확장**
1. Yahoo Finance / World Bank 연동
2. 대시보드 고도화
3. 리포트 필터/검색
4. 수동 리포트 생성
5. 다크모드

**Phase 3 - 고도화**
1. 멀티 에이전트 토론 시스템
2. 이메일 리포트 전달
3. 리포트 공유 기능
4. 포트폴리오 분석
